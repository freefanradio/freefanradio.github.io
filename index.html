---
layout: default
title: "Home"
description: "The Canadian hub for legal sports radio streams and podcasts. Your recent radio stations at your fingertips."
---

<style>
/* Mobile-first, full-screen layout with no scroll */
html, body {
    margin: 0;
    padding: 0;
    height: 100%;
    overflow: hidden; /* Prevent all scrolling */
}

/* Hide only footer on home page, keep header for navigation */
.site-footer {
    display: none;
}

/* Ensure header is visible and properly positioned */
.site-header {
    position: relative;
    z-index: 100;
}

/* Ensure audio player is accessible but positioned properly */
#audioPlayer {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    z-index: 1000;
    display: block !important;
}

/* Adjust main content to account for fixed header */
.main-content {
    position: fixed;
    top: 64px; /* Start below fixed header */
    left: 0;
    right: 0;
    bottom: 0; /* Stretch to bottom of viewport */
    overflow: hidden;
    padding: 0;
}

.home-container {
    display: flex;
    flex-direction: column;
    height: 100%;
    width: 100%;
    overflow: hidden;
}

.stations-container {
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    padding: 0.75rem;
    background: #f8fafc;
    min-height: 0; /* Important for flex containers */
    transition: padding-bottom 0.3s ease; /* Smooth transition when player appears */
}

/* Adjust container when audio player is active */
.stations-container.player-active {
    padding-bottom: 100px; /* Make room for audio player - increased for safety */
}

/* On larger screens, less padding needed since grid is shorter */
@media (min-width: 768px) {
    .stations-container.player-active {
        padding-bottom: 90px; /* Less padding needed for horizontal layout */
    }
}

.stations-grid {
    flex: 1;
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 0.75rem;
    overflow: hidden;
    min-height: 0; /* Important for grid in flex container */
}

/* For larger screens, use 4 columns */
@media (min-width: 768px) {
    .stations-grid {
        grid-template-columns: repeat(4, 1fr);
        gap: 1rem;
        padding: 0 1rem;
    }
}

.station-slot {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border-radius: 12px;
    padding: 1rem;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
    transition: all 0.3s ease;
    border: 2px solid transparent;
    position: relative;
    overflow: hidden;
    color: white;
    cursor: pointer;
}

.station-slot:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 16px rgba(0,0,0,0.15);
    background: linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%);
}

.station-slot:active {
    transform: scale(0.98);
}

.station-slot.empty {
    background: #f1f5f9;
    border: 2px dashed #cbd5e0;
    color: #94a3b8;
    cursor: default;
}

.station-slot.empty:hover {
    transform: none;
    background: #f1f5f9;
}

.station-slot.playing {
    border-color: #10b981;
    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
}

.station-slot.loading {
    background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
    position: relative;
}

.station-slot.loading::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 20px;
    height: 20px;
    border: 2px solid transparent;
    border-top: 2px solid white;
    border-radius: 50%;
    animation: spin 1s linear infinite;
}

@keyframes spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}

.station-info {
    width: 100%;
}

.station-name {
    font-size: clamp(0.9rem, 2.5vw, 1.1rem);
    font-weight: 600;
    color: white;
    margin: 0;
    line-height: 1.3;
    display: -webkit-box;
    -webkit-line-clamp: 3;
    line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.empty-slot-content {
    font-size: clamp(0.7rem, 1.8vw, 0.8rem);
    text-align: center;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start; /* Align to top */
    height: 100%;
    width: 100%;
    padding-top: 1rem; /* Push button away from very top edge */
}

.browse-btn {
    background: #667eea;
    color: white;
    border: none;
    border-radius: 6px;
    padding: 0.4rem 0.6rem;
    font-size: clamp(0.65rem, 1.5vw, 0.7rem);
    font-weight: 500;
    cursor: pointer;
    transition: all 0.3s ease;
    margin-bottom: auto; /* Push to top, icon to bottom */
}

.browse-btn:hover {
    background: #5a67d8;
}

.last-played {
    font-size: 0.6rem;
    color: #94a3b8;
    margin-top: 0.25rem;
    text-align: right;
}

</style>

<div class="home-container">
    <!-- Stations Container -->
    <div class="stations-container">
        <div class="stations-grid" id="stationsGrid">
            <!-- 8 slots will be populated by JavaScript -->
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    console.log('Home page DOM loaded, initializing...');
    initializeRecentStationsView();
});

function initializeRecentStationsView() {
    console.log('Initializing recent stations view...');
    const stationsGrid = document.getElementById('stationsGrid');
    
    // Wait for radioPlayer to be available
    const checkRadioPlayer = () => {
        if (window.radioPlayer) {
            console.log('Radio player found, updating stations grid');
            updateStationsGrid();
            updateLayoutForPlayer(); // Check if player is already active
        } else {
            console.log('Radio player not ready yet, checking again...');
            setTimeout(checkRadioPlayer, 100);
        }
    };
    checkRadioPlayer();
    
    function updateStationsGrid() {
        let recentStations = window.radioPlayer ? window.radioPlayer.getRecentStationsForDisplay() : [];
        
        // If no recent stations, show some featured stations as fallback
        if (recentStations.length === 0) {
            recentStations = getDefaultStations();
        }
        
        // Sort stations alphabetically by name for consistent UI positioning
        recentStations.sort((a, b) => a.name.localeCompare(b.name));
        
        const maxSlots = 8;
        
        stationsGrid.innerHTML = '';
        
        // No subtitle to update anymore - just the grid
        
        // Create all 8 slots
        for (let i = 0; i < maxSlots; i++) {
            const slot = document.createElement('div');
            slot.className = 'station-slot';
            
            if (i < recentStations.length) {
                // Populated slot
                const station = recentStations[i];
                slot.innerHTML = `
                    <div class="station-info">
                        <h3 class="station-name">${station.name}</h3>
                    </div>
                `;
                
                // Store station data directly on the slot element and make entire card clickable
                slot.stationData = station;
                slot.style.cursor = 'pointer';
                
                // Add click handler for the entire station slot
                slot.addEventListener('click', function(event) {
                    event.preventDefault();
                    console.log('üéµ Play button clicked for:', this.dataset.name);
                    
                    try {
                        const stationData = this.stationData;
                        console.log('üìª Station data:', stationData);
                        
                        if (!window.radioPlayer) {
                            console.error('‚ùå Radio player not available!');
                            alert('Radio player not ready. Please refresh the page and try again.');
                            return;
                        }
                        
                        console.log('üöÄ Loading station:', stationData.name);
                        console.log('üîó Stream URL:', stationData.url);
                        
                        // Add loading state to the station slot
                        this.classList.add('loading');
                        
                        // Test if we can create an audio element first
                        const testAudio = new Audio();
                        testAudio.src = stationData.url;
                        testAudio.load();
                        
                        console.log('‚úÖ Audio element created successfully');
                        
                        // Now use the radio player
                        window.radioPlayer.loadStation(stationData.url, stationData.name, stationData);
                        
                        // Reset loading state after a delay
                        setTimeout(() => {
                            this.classList.remove('loading');
                            updatePlayingStates();
                        }, 2000);
                        
                    } catch (error) {
                        console.error('‚ùå Error in play button handler:', error);
                        alert(`Error playing station: ${error.message}`);
                    }
                });
                
            } else {
                // Empty slot
                slot.classList.add('empty');
                slot.innerHTML = `
                    <div class="empty-slot-content">
                        <button class="browse-btn" onclick="window.location.href='/sports/'">
                            Browse All
                        </button>
                        <div style="font-size: 1.2rem; margin-top: 0.5rem; opacity: 0.4;">
                            <i class="fas fa-radio"></i>
                        </div>
                    </div>
                `;
            }
            
            stationsGrid.appendChild(slot);
        }
        
        updatePlayingStates();
    }
    
    function updatePlayingStates() {
        // Remove all playing states
        document.querySelectorAll('.station-slot').forEach(slot => {
            slot.classList.remove('playing');
        });
        
        // Add playing state to current station
        if (window.radioPlayer && window.radioPlayer.currentStation) {
            const currentUrl = window.radioPlayer.currentStation.url;
            // Find the slot with matching station data
            document.querySelectorAll('.station-slot').forEach(slot => {
                if (slot.stationData && slot.stationData.url === currentUrl) {
                    slot.classList.add('playing');
                }
            });
        }
    }
    
    // Listen for radio player events to update states
    setInterval(() => {
        if (window.radioPlayer) {
            updatePlayingStates();
            updateLayoutForPlayer();
        }
    }, 1000);
    
    function updateLayoutForPlayer() {
        const stationsContainer = document.querySelector('.stations-container');
        const audioPlayer = document.getElementById('audioPlayer');
        const isVertical = window.innerWidth < 768;
        
        if (audioPlayer && audioPlayer.classList.contains('active')) {
            stationsContainer.classList.add('player-active');
            console.log(`üéµ Audio player active - adjusting layout (${isVertical ? 'vertical' : 'horizontal'} mode)`);
        } else {
            stationsContainer.classList.remove('player-active');
            console.log('üîá Audio player inactive - normal layout');
        }
    }
    
    // Watch for audio player changes with MutationObserver (more reliable)
    function setupAudioPlayerWatcher() {
        const audioPlayer = document.getElementById('audioPlayer');
        if (audioPlayer) {
            const observer = new MutationObserver((mutations) => {
                mutations.forEach((mutation) => {
                    if (mutation.type === 'attributes' && mutation.attributeName === 'class') {
                        updateLayoutForPlayer();
                    }
                });
            });
            
            observer.observe(audioPlayer, {
                attributes: true,
                attributeFilter: ['class']
            });
            
            // Initial check
            updateLayoutForPlayer();
            console.log('üëÄ Audio player watcher set up');
        } else {
            // If audio player doesn't exist yet, try again later
            setTimeout(setupAudioPlayerWatcher, 500);
        }
    }
    
    // Start watching for audio player changes
    setupAudioPlayerWatcher();
    
    // Update layout on window resize (orientation change)
    window.addEventListener('resize', () => {
        updateLayoutForPlayer();
    });
    
    // Listen for recent stations updates
    window.addEventListener('recentStationsUpdated', function(event) {
        setTimeout(updateStationsGrid, 100);
    });
    
    function getDefaultStations() {
        // Default featured stations for first-time users (sorted alphabetically)
        return [
            {
                name: "CJOB 680 Winnipeg",
                url: "https://playerservices.streamtheworld.com/api/livestream-redirect/CJOBAM.mp3",
                frequency: "680 AM",
                location: "Winnipeg, MB",
                genre: "News/Sports",
                description: "Winnipeg's news and sports radio",
                timeAgo: "Featured"
            },
            {
                name: "Sportsnet 960 Calgary",
                url: "https://playerservices.streamtheworld.com/api/livestream-redirect/CFACAM.mp3",
                frequency: "960 AM",
                location: "Calgary, AB",
                genre: "Sports Talk",
                description: "Calgary's sports radio station",
                timeAgo: "Featured"
            },
            {
                name: "TSN 1050 Toronto",
                url: "https://playerservices.streamtheworld.com/api/livestream-redirect/CJCL.mp3",
                frequency: "1050 AM",
                location: "Toronto, ON",
                genre: "Sports Talk",
                description: "Toronto's sports radio leader",
                timeAgo: "Featured"
            },
            {
                name: "TSN 690 Montreal",
                url: "https://playerservices.streamtheworld.com/api/livestream-redirect/CKGMAM.mp3",
                frequency: "690 AM",
                location: "Montreal, QC",
                genre: "Sports Talk",
                description: "Montreal's premier sports radio station",
                timeAgo: "Featured"
            }
        ];
    }
}
</script>
